<!-- public/admin.html -->
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <title>å«è™Ÿå¾Œå° - é‚£ç©ºæ²™æ—º</title>
  <link rel="stylesheet" href="./style.css">
</head>
<body>
  <main class="container">
    <h1>ğŸ”’ è€é—†å«è™Ÿå¾Œå°</h1>

    <div id="auth-section">
      <input type="password" id="admin-password" placeholder="è«‹è¼¸å…¥å¯†ç¢¼">
      <button onclick="verifyPassword()">ç™»å…¥</button>
    </div>

    <div id="admin-panel" class="hidden">
      <h2>ğŸ‘¥ ç›®å‰è™Ÿç¢¼ï¼š<span id="current-number">å°šæœªé–‹å§‹</span></h2>
      <p id="current-info">--</p>
      <button onclick="nextNumber()" class="primary">â–¶ï¸ ä¸‹ä¸€è™Ÿ</button>
      <button onclick="resetQueue()" class="danger">ğŸ” é‡ç½®æ‰€æœ‰è™Ÿç¢¼</button>
    </div>
  </main>

  <script>
    let password = '';

    function verifyPassword() {
      const input = document.getElementById('admin-password').value;
      if (input === 'sawanpass') {
        password = input;
        document.getElementById('auth-section').classList.add('hidden');
        document.getElementById('admin-panel').classList.remove('hidden');
        fetchCurrent();
      } else {
        alert('å¯†ç¢¼éŒ¯èª¤');
      }
    }

    async function fetchCurrent() {
      const res = await fetch(`/api/current`);
      const data = await res.json();
      if (data.current) {
        document.getElementById('current-number').textContent = `${data.current.number} è™Ÿ`;
        document.getElementById('current-info').textContent = `${data.current.name} ${data.current.gender}`;
      }
    }

    async function nextNumber() {
      const res = await fetch(`/api/next?password=${password}`);
      const data = await res.json();
      if (data.success) fetchCurrent();
      else alert(data.message);
    }

    async function resetQueue() {
      if (confirm('ç¢ºå®šè¦é‡ç½®å…¨éƒ¨è™Ÿç¢¼å—ï¼Ÿ')) {
        const res = await fetch(`/api/reset?password=${password}`);
        const data = await res.json();
        if (data.success) {
          alert('å·²é‡ç½®');
          fetchCurrent();
        } else {
          alert(data.message);
        }
      }
    }
  </script>
</body>
</html>
